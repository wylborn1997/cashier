<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <title></title>
    <!--preload-links-->
    <!--app-context-->
    <style>
      #id {
        width: 200px;
        height: 150px;
        background: blue;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <div id="button">我是按钮</div>
    </div>
    <!-- <script type="module" src="/main.js"></script> -->
  </body>
  <script type="text/javascript">
    var userAgent = navigator.userAgent;
    if (userAgent.indexOf("AlipayClient") > -1) {
      // 支付宝小程序的 JS-SDK 防止 404 需要动态加载，如果不需要兼容支付宝小程序，则无需引用此 JS 文件。
      document.writeln(
        '<script src="https://appx/web-view.min.js"' +
          ">" +
          "<" +
          "/" +
          "script>"
      );
    } else if (/QQ/i.test(userAgent) && /miniProgram/i.test(userAgent)) {
      // QQ 小程序
      document.write(
        '<script type="text/javascript" src="https://qqq.gtimg.cn/miniprogram/webview_jssdk/qqjssdk-1.0.0.js"><\/script>'
      );
    } else if (
      /miniProgram/i.test(userAgent) &&
      /micromessenger/i.test(userAgent)
    ) {
      // 微信小程序 JS-SDK 如果不需要兼容微信小程序，则无需引用此 JS 文件。
      document.write(
        '<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"><\/script>'
      );
    } else if (/toutiaomicroapp/i.test(userAgent)) {
      // 头条小程序 JS-SDK 如果不需要兼容头条小程序，则无需引用此 JS 文件。
      document.write(
        '<script type="text/javascript" src="https://s3.pstatp.com/toutiao/tmajssdk/jssdk-1.0.1.js"><\/script>'
      );
    } else if (/swan/i.test(userAgent)) {
      // 百度小程序 JS-SDK 如果不需要兼容百度小程序，则无需引用此 JS 文件。
      document.write(
        '<script type="text/javascript" src="https://b.bdstatic.com/searchbox/icms/searchbox/js/swan-2.0.18.js"><\/script>'
      );
    } else if (/quickapp/i.test(userAgent)) {
      // quickapp
      document.write(
        '<script type="text/javascript" src="https://quickapp/jssdk.webview.min.js"><\/script>'
      );
    }
    if (
      !/toutiaomicroapp/i.test(userAgent) &&
      document.querySelector(".post-message-section")
    ) {
      document.querySelector(".post-message-section").style.visibility =
        "visible";
    }
  </script>
  <script
    type="text/javascript"
    src="https://js.cdn.aliyun.dcloud.net.cn/dev/uni-app/uni.webview.1.5.2.js"
  ></script>
  <script type="text/javascript">
    var uniWebView = uni.webView; //必须在这时候保存下来
    console.log(uniWebView);
    uniWebView.getEnv(function (res) {
      console.log("当前环境：" + JSON.stringify(res));
    });
    let mybutton = document.getElementById("button");
    mybutton.addEventListener("click", () => {
      uniWebView.navigateBack({
        delta: 1,
      });
      uniWebView.postMessage({
        data: {
          action: "navigateToAnotherMiniProgram",
          extraData: {
            payInfo: {
              appId: "wx01d7113123125809",
              nonceStr: "1prGyUk4MoI3FjFfkpt66uYlzSTWuCRh",
              package: "prepay_id=wx17110105322248500ea09a82252d3e0000",
              paySign:
                "Rcz8dTKrVW1twPjlm5nOfgzdNHPuAXdWjCbwIYIY0hZCuIIG3LNQXZNCVFfpTSccdZEK+4PHsxFJF49wpedO8egmgCvUgnkbRsIg3nmwOJiV7JA5SJQz8he+3W4BWx5OTSkLG+V5qpqPe/7LMan80JEMCotg3XP0Elc7Pbhv2njnmsGbbiMKk0BWZ6VnemUBkC9/Inr5bmMqrBmmQtpQCc/pWRrmODYRr54DbBzmfwsKlO+Fm9xqxWvgtqW+VRgiwJoNDLgcGRGCsp5kIW7vFtlmUm13IHZBs35h3r4YfqS0S2xHmyyfxjFcOc7AAocsgbzH8gVTIC02SW1/ZSonbQ==",
              signType: "RSA",
              timeStamp: "1718593265",
            },
          },
        },
      });
      console.log("传递成功");
    });
  </script>
</html>
